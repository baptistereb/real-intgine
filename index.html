<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>REAL INTGINE !!!</title>
	<link rel="stylesheet" type="text/css" href="sources/style.css">
</head>
<body>
	<ul>
		<input id="button1" type="submit" value="MAP 1 : forme alÃ©atoire" class="bouton"/><input id="button2" type="submit" value="MAP 2 : INSA" class="bouton"/><input id="button3" type="submit" value="MAP 3 : cube" class="bouton"/><input id="button4" type="submit" value="MAP 4 : table basse" class="bouton"/><input id="button5" type="submit" value="MAP 5 : tore" class="bouton"/><a href="./map/" target="_new"><input type="submit" value="Autres map..." class="bouton"/></a>
		<div id="title">REAL INTGINE</div>
	</ul>
	<section align="center">
		<div id="mid">
			<canvas id="Canvas" width="1280" height="720"></canvas>
		</div>

	    <div id="mid" class="mid2">
			<span>Data :</span>
	    	<table>
			        <tr>
			            <td width="75%">camera.x</td>
			            <td width="25%">
			            	<p id="camerax">Erreur</p>
			            </td>
			        </tr>
			        <tr>
			            <td>camera.y</td>
			            <td>
			            	<p id="cameray">Erreur</p>
			            </td>
			        </tr>
			        <tr>
			            <td>camera.z</td>
			            <td>
				            <p id="cameraz">Erreur</p>
				        </td>
			        </tr>
			        <tr>
			            <td>camera_angle.x</td>
			            <td>
		    				<p id="camera_anglex">Erreur</p>
			            </td>
			        </tr>
			        <tr>
			            <td>camera_angle.y</td>
			            <td>
		   					<p id="camera_angley">Erreur</p>
			            </td>
			        </tr>
			        <tr>
			            <td>camera_angle.z</td>
			            <td>
		    				<p id="camera_anglez">Erreur</p>
			            </td>
			        </tr>
			        <tr>
			            <td>fov</td>
			            <td>
		    				<p id="fov">Erreur</p>
			            </td>
			        </tr>
			        <tr>
			            <td>nb faces</td>
			            <td>
		    				<p id="nb_face">Erreur</p>
			            </td>
			        </tr>
			        <tr>
			            <td>fps</td>
			            <td>
		    				<p id="fps">...</p>
			            </td>
			        </tr>
			</table>
			<span>Commandes :</span>
	    	<table>
			        <tr>
			            <td><input type="checkbox" id="mouseevent" name="mouseevent"></td>
			            <td>Souris</td>
			        </tr>
			        <tr id="z">
			            <td width="25%">z :</td>
			            <td width="75%">
			            	monter
			            </td>
			        </tr>
			        <tr id="s">
			            <td width="25%">s :</td>
			            <td width="75%">
			            	descendre
			            </td>
			        </tr>
			        <tr id="q">
			            <td width="25%">q :</td>
			            <td width="75%">
			            	x-
			            </td>
			        </tr>
			        <tr id="d">
			            <td width="25%">d :</td>
			            <td width="75%">
			            	x+
			            </td>
			        </tr>
			        <tr id="a">
			            <td width="25%">a :</td>
			            <td width="75%">
			            	y-
			            </td>
			        </tr>
			        <tr id="e">
			            <td width="25%">e :</td>
			            <td width="75%">
			            	y+
			            </td>
			        </tr>
			        <tr>
			        	<td>
			        		<input type="color" id="colorinput" class="colorinput" value="#FF0000">
			        	</td>
			        	<td>
			        		<p id="coloroutput1">#FF0000</p>
			        	</td>
			        </tr>
			</table>
			<span>Import (.smf) :</span>
			<input type="file" name="inputFile" id="inputFile">
	    	<pre id="output"></pre>
	    	<table>
		</div>
	</section>

	<script src="sources/js/real-intgine.js"></script>
	<script type="text/javascript">
		let test = new RealIntgine("Canvas")

		test.ChargerMap("button1", 31, -25, -34, 1.42, 0, 3.68, 1200, "map/map1.smf")
		test.ChargerMap("button2", -24, -20, -31, 1.08, 0, 2.76 , 1200, "map/map2.smf")
		test.ChargerMap("button3", -17, -23, -18, 1.39, 0, 2.36, 1200, "map/map3.smf")
		test.ChargerMap("button4", -12, -292, -245, 1.44, 0, -3.2, 1200, "map/map4.smf")
		test.ChargerMap("button5", -9, -37, -105, 1.35, 0, -3.15, 1200, "map/map5.smf")
		test.ChargerMapWithInput("inputFile")

		function round(x) {
			return Math.round(x*100)/100
		}

		function ReloadKey(k) {
			if(k.type == "keyup") {
				switch(k.keyCode) {
			        case 68 : // d
			        	document.getElementById("d").style.color = "white";
			            break;
			        case 81: // q
			        	document.getElementById("q").style.color = "white";
			            break;
			        case 69: // e
			        	document.getElementById("e").style.color = "white";
			            break;
			        case 65: // a
			        	document.getElementById("a").style.color = "white";
			            break;
			        case 90: // z
			        	document.getElementById("z").style.color = "white";
			            break;
			        case 83: // s
			        	document.getElementById("s").style.color = "white";
			            break;
			    }
			} else {
				switch(k.keyCode) {
			        case 68 : // d
			        	document.getElementById("d").style.color = "#00ADB5";
			            break;
			        case 81: // q
			        	document.getElementById("q").style.color = "#00ADB5";
			            break;
			        case 69: // e
			        	document.getElementById("e").style.color = "#00ADB5";
			            break;
			        case 65: // a
			        	document.getElementById("a").style.color = "#00ADB5";
			            break;
			        case 90: // z
			        	document.getElementById("z").style.color = "#00ADB5";
			            break;
			        case 83: // s
			        	document.getElementById("s").style.color = "#00ADB5";
			            break;
			    }
			}
		}

		setInterval(() => {
			document.getElementById("camerax").textContent = (-1)*round(test.camera.x)
			document.getElementById("cameray").textContent = (-1)*round(test.camera.y)
			document.getElementById("cameraz").textContent = (-1)*round(test.camera.z)
			document.getElementById("camera_anglex").textContent = round(test.camera_angle.x)
			document.getElementById("camera_angley").textContent = round(test.camera_angle.y)
			document.getElementById("camera_anglez").textContent = round(test.camera_angle.z)
			document.getElementById("fov").textContent = round(test.fov*100)/100;
			document.getElementById("nb_face").textContent = test.triangle_list_length;
			if (document.getElementById("mouseevent").checked === true) {
			    test.mouseeventon = true
			} else {
				test.mouseeventon = false
			}
		})

		setInterval(function () {document.getElementById("fps").textContent = test.fps}.bind(this), 500);

		document.addEventListener("keydown",this.ReloadKey.bind(this));
		document.addEventListener("keyup",this.ReloadKey.bind(this));

		document.getElementById('colorinput').addEventListener('change', function(e) {
			document.querySelectorAll("p").forEach((p) => {
				test.colormap = e.target.value;
				document.getElementById("coloroutput").textContent = e.target.value;
			});
		});
	</script>
</body>
</html>